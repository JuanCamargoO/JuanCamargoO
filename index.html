<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Experiencia WebAR</title>
    <script src="https://aframe.io/releases/1.2.0/aframe.min.js"></script>
    <script src="https://cdn.rawgit.com/jeromeetienne/AR.js/1.7.2/aframe/build/aframe-ar.min.js"></script>
    <style>
        body, html {
            margin: 0;
            padding: 0;
            overflow: hidden;
            height: 100%;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
        }
        h2 {
            position: absolute;
            top: 10px;
            left: 50%;
            transform: translateX(-50%);
            z-index: 10;
            color: white;
            text-shadow: 1px 1px 5px black;
        }
        #buttons-container {
            position: absolute;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            z-index: 10;
        }
        #photoButton, #videoButton {
            padding: 10px 20px;
            margin: 0 10px;
            font-size: 16px;
            cursor: pointer;
        }
        @media (max-width: 600px) {
            #photoButton, #videoButton {
                font-size: 12px;
                padding: 8px 15px;
            }
        }
    </style>
</head>
<body>
    <!-- Mensaje para autorizar la cámara -->
    <h2>Autoriza el uso de la cámara para vivir la experiencia en realidad aumentada</h2>

    <!-- Contenedor de la experiencia AR -->
    <a-scene vr-mode-ui="enabled: false" embedded arjs="sourceType: webcam;">

        <!-- Experiencia 1 con Pattern 1 -->
        <a-marker preset="custom" type="pattern" url="patron1.patt">
            <a-gltf-model src="experiencia1.glb" position="0 0 0" scale="0.5 0.5 0.5"></a-gltf-model>
        </a-marker>

        <!-- Experiencia 2 con Pattern 2 -->
        <a-marker preset="custom" type="pattern" url="patron2.patt">
            <a-gltf-model src="experiencia2.glb" position="0 0 0" scale="0.5 0.5 0.5"></a-gltf-model>
        </a-marker>

        <!-- Experiencia 3 con Pattern 3 -->
        <a-marker preset="custom" type="pattern" url="patron3.patt">
            <a-gltf-model src="experiencia3.glb" position="0 0 0" scale="0.5 0.5 0.5"></a-gltf-model>
        </a-marker>

        <!-- Experiencia 4 con Pattern 4 -->
        <a-marker preset="custom" type="pattern" url="patron4.patt">
            <a-gltf-model src="experiencia4.glb" position="0 0 0" scale="0.5 0.5 0.5"></a-gltf-model>
        </a-marker>

        <!-- Experiencia 5 con Pattern 5 -->
        <a-marker preset="custom" type="pattern" url="patron5.patt">
            <a-gltf-model src="experiencia5.glb" position="0 0 0" scale="0.5 0.5 0.5"></a-gltf-model>
        </a-marker>

        <!-- Experiencia 6 con Pattern 6 -->
        <a-marker preset="custom" type="pattern" url="patron6.patt">
            <a-gltf-model src="experiencia6.glb" position="0 0 0" scale="0.5 0.5 0.5"></a-gltf-model>
        </a-marker>

        <!-- Botones para tomar fotos y grabar videos -->
        <div id="buttons-container">
            <button id="photoButton">Tomar Foto</button>
            <button id="videoButton">Grabar Video</button>
        </div>
    </a-scene>

    <script>
        // Verificación de compatibilidad del navegador para Geolocalización y AR.js
        if (!navigator.geolocation) {
            alert("Tu navegador no soporta geolocalización. Por favor, utiliza un navegador compatible.");
        }

        // Función para obtener la geolocalización del usuario
        navigator.geolocation.getCurrentPosition(success, error, {
            enableHighAccuracy: true,
            timeout: 5000,
            maximumAge: 0
        });

        function success(position) {
            const lat = position.coords.latitude;
            const lng = position.coords.longitude;
            const rango = 0.02; // Rango de 20 metros

            // Verifica la distancia a las coordenadas específicas
            if (distance(lat, lng, 8.950778, -79.670555) > rango) {
                // Redirige a YouTube si se sale del rango
                alert("Estás fuera del rango de la experiencia. Serás redirigido.");
                window.location.href = "https://www.youtube.com/ficticio";
            }
        }

        function error(err) {
            console.warn(`ERROR(${err.code}): ${err.message}`);
            alert("No se pudo obtener la geolocalización. La experiencia no podrá ser vivida correctamente.");
        }

        // Función para calcular la distancia entre dos coordenadas (haversine formula)
        function distance(lat1, lon1, lat2, lon2) {
            const R = 6371; // Radio de la tierra en km
            const dLat = deg2ra
